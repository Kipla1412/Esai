USER QUERY
   ↓
TOKENIZE (batchsearch)
   ↓
RETRIEVE TOP-N CONTEXTS (vector store search)
   ↓
BUILD PROMPT (question + context)
   ↓
LLM GENERATES ANSWER
   ↓
[Optional] SNIPPETS (shorten from context)
   ↓
[Optional] REFERENCE (find best matching doc id)
   ↓
APPLY FORMAT (flatten, reference, default)
   ↓
FINAL OUTPUT





agent:
  film_agent:
    model:
      type: "InferenceClientModel"
      model_id: "mistralai/Mistral-7B-Instruct-v0.2"
      token: "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"
    tools:
      - type: "DuckDuckGoSearchTool"